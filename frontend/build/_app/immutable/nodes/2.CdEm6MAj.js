import{s as se,n as W,o as re,a as ie,r as ce}from"../chunks/scheduler.BjFDxd0B.js";import{S as ue,i as fe,s as O,e as b,f as P,c as v,a as S,k as z,d as E,l as k,g as A,h as i,m as R,t as j,b as M,n as B,o as X,p as ne,q as ae,j as Q,r as Z,u as he}from"../chunks/index.Ca89P9pl.js";function H(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function x(r,e,t){const n=r.slice();return n[9]=e[t],n}function $(r,e,t){const n=r.slice();return n[12]=e[t],n}function ee(r){let e,t,n,c="Ask Questions",h,f,a,o,s,l,g="Select a book",d,p,y,u,C,T,U,N,D,K,V,F=H(r[0]),q=[];for(let m=0;m<F.length;m+=1)q[m]=te($(r,F,m));let I=r[2].text&&le(r);return{c(){e=b("section"),t=b("article"),n=b("h4"),n.textContent=c,h=O(),f=b("hr"),a=O(),o=b("form"),s=b("select"),l=b("option"),l.textContent=g;for(let m=0;m<q.length;m+=1)q[m].c();d=O(),p=b("label"),y=j(`Percentage
                    `),u=b("input"),C=O(),T=b("input"),U=O(),N=b("input"),D=O(),I&&I.c(),this.h()},l(m){e=v(m,"SECTION",{id:!0});var w=S(e);t=v(w,"ARTICLE",{});var _=S(t);n=v(_,"H4",{"data-svelte-h":!0}),z(n)!=="svelte-1stl1xm"&&(n.textContent=c),h=P(_),f=v(_,"HR",{}),a=P(_),o=v(_,"FORM",{});var L=S(o);s=v(L,"SELECT",{name:!0,"aria-label":!0});var Y=S(s);l=v(Y,"OPTION",{"data-svelte-h":!0}),z(l)!=="svelte-1jbl809"&&(l.textContent=g);for(let J=0;J<q.length;J+=1)q[J].l(Y);Y.forEach(E),d=P(L),p=v(L,"LABEL",{for:!0});var G=S(p);y=M(G,`Percentage
                    `),u=v(G,"INPUT",{type:!0,name:!0,placeholder:!0,"aria-label":!0,min:!0,max:!0}),G.forEach(E),C=P(L),T=v(L,"INPUT",{type:!0,name:!0,placeholder:!0,"aria-label":!0}),U=P(L),N=v(L,"INPUT",{type:!0}),L.forEach(E),D=P(_),I&&I.l(_),_.forEach(E),w.forEach(E),this.h()},h(){l.selected=!0,l.disabled=!0,l.__value="",B(l,l.__value),k(s,"name","select"),k(s,"aria-label","Select"),s.required=!0,r[1].book===void 0&&ie(()=>r[5].call(s)),k(u,"type","number"),k(u,"name","percentage"),k(u,"placeholder","Percentage"),k(u,"aria-label","Percentage"),k(u,"min","0"),k(u,"max","100"),k(p,"for","percentage"),k(T,"type","search"),k(T,"name","search"),k(T,"placeholder","Your Question"),k(T,"aria-label","Search"),k(N,"type","submit"),N.value="Submit",k(e,"id","questions-form")},m(m,w){A(m,e,w),i(e,t),i(t,n),i(t,h),i(t,f),i(t,a),i(t,o),i(o,s),i(s,l);for(let _=0;_<q.length;_+=1)q[_]&&q[_].m(s,null);X(s,r[1].book,!0),i(o,d),i(o,p),i(p,y),i(p,u),B(u,r[1].percentage),i(o,C),i(o,T),B(T,r[1].question),i(o,U),i(o,N),i(t,D),I&&I.m(t,null),K||(V=[R(s,"change",r[5]),R(u,"input",r[6]),R(T,"input",r[7]),R(N,"click",r[3])],K=!0)},p(m,w){if(w&1){F=H(m[0]);let _;for(_=0;_<F.length;_+=1){const L=$(m,F,_);q[_]?q[_].p(L,w):(q[_]=te(L),q[_].c(),q[_].m(s,null))}for(;_<q.length;_+=1)q[_].d(1);q.length=F.length}w&3&&X(s,m[1].book),w&3&&ne(u.value)!==m[1].percentage&&B(u,m[1].percentage),w&3&&T.value!==m[1].question&&B(T,m[1].question),m[2].text?I?I.p(m,w):(I=le(m),I.c(),I.m(t,null)):I&&(I.d(1),I=null)},d(m){m&&E(e),ae(q,m),I&&I.d(),K=!1,ce(V)}}}function te(r){let e,t=r[12]+"",n,c,h;return{c(){e=b("option"),n=j(t),c=O(),this.h()},l(f){e=v(f,"OPTION",{});var a=S(e);n=M(a,t),c=P(a),a.forEach(E),this.h()},h(){e.__value=h=r[12],B(e,e.__value)},m(f,a){A(f,e,a),i(e,n),i(e,c)},p(f,a){a&1&&t!==(t=f[12]+"")&&Q(n,t),a&1&&h!==(h=f[12])&&(e.__value=h,B(e,e.__value))},d(f){f&&E(e)}}}function le(r){let e,t=r[2].text+"",n,c,h,f=H(r[2].documents),a=[];for(let o=0;o<f.length;o+=1)a[o]=oe(x(r,f,o));return{c(){e=b("blockquote"),n=j(t),c=O();for(let o=0;o<a.length;o+=1)a[o].c();h=Z()},l(o){e=v(o,"BLOCKQUOTE",{});var s=S(e);n=M(s,t),s.forEach(E),c=P(o);for(let l=0;l<a.length;l+=1)a[l].l(o);h=Z()},m(o,s){A(o,e,s),i(e,n),A(o,c,s);for(let l=0;l<a.length;l+=1)a[l]&&a[l].m(o,s);A(o,h,s)},p(o,s){if(s&4&&t!==(t=o[2].text+"")&&Q(n,t),s&4){f=H(o[2].documents);let l;for(l=0;l<f.length;l+=1){const g=x(o,f,l);a[l]?a[l].p(g,s):(a[l]=oe(g),a[l].c(),a[l].m(h.parentNode,h))}for(;l<a.length;l+=1)a[l].d(1);a.length=f.length}},d(o){o&&(E(e),E(c),E(h)),ae(a,o)}}}function oe(r){let e,t,n=r[9].position+"",c,h,f,a=r[9].content+"",o,s;return{c(){e=b("details"),t=b("summary"),c=j(n),h=O(),f=b("blockquote"),o=j(a),s=O()},l(l){e=v(l,"DETAILS",{});var g=S(e);t=v(g,"SUMMARY",{});var d=S(t);c=M(d,n),d.forEach(E),h=P(g),f=v(g,"BLOCKQUOTE",{});var p=S(f);o=M(p,a),p.forEach(E),s=P(g),g.forEach(E)},m(l,g){A(l,e,g),i(e,t),i(t,c),i(e,h),i(e,f),i(f,o),i(e,s)},p(l,g){g&4&&n!==(n=l[9].position+"")&&Q(c,n),g&4&&a!==(a=l[9].content+"")&&Q(o,a)},d(l){l&&E(e)}}}function pe(r){let e,t,n,c,h="Import Books",f,a,o,s,l,g,d,p,y,u=r[0].length>0&&ee(r);return{c(){u&&u.c(),e=O(),t=b("section"),n=b("article"),c=b("h4"),c.textContent=h,f=O(),a=b("hr"),o=O(),s=b("form"),l=b("input"),g=O(),d=b("input"),this.h()},l(C){u&&u.l(C),e=P(C),t=v(C,"SECTION",{id:!0});var T=S(t);n=v(T,"ARTICLE",{});var U=S(n);c=v(U,"H4",{"data-svelte-h":!0}),z(c)!=="svelte-1r86v61"&&(c.textContent=h),f=P(U),a=v(U,"HR",{}),o=P(U),s=v(U,"FORM",{});var N=S(s);l=v(N,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),g=P(N),d=v(N,"INPUT",{type:!0}),N.forEach(E),U.forEach(E),T.forEach(E),this.h()},h(){k(l,"type","file"),k(l,"id","file"),k(l,"name","file"),k(l,"accept",".epub"),k(d,"type","submit"),d.value="Import",k(t,"id","upload-form")},m(C,T){u&&u.m(C,T),A(C,e,T),A(C,t,T),i(t,n),i(n,c),i(n,f),i(n,a),i(n,o),i(n,s),i(s,l),i(s,g),i(s,d),p||(y=R(d,"click",r[4]),p=!0)},p(C,[T]){C[0].length>0?u?u.p(C,T):(u=ee(C),u.c(),u.m(e.parentNode,e)):u&&(u.d(1),u=null)},i:W,o:W,d(C){C&&(E(e),E(t)),u&&u.d(C),p=!1,y()}}}function me(r,e,t){let n=[];re(o);let c={question:"",book:"",percentage:100},h={text:"",documents:[]};async function f(){try{console.log(c);const d=await fetch("ask-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),p=await d.json();d.ok?(t(2,h.text=p.answer,h),t(2,h.documents=p.documents,h)):console.error(p.error)}catch(d){console.error("Fetch error:",d)}}async function a(){const d=document.getElementById("file"),p=new FormData;d.files&&p.append("file",d.files[0]);try{const y=await fetch("upload-file",{method:"POST",body:p}),u=await y.json();y.ok?await o():console.error("Fetch error:",u.error)}catch(y){console.error("Fetch error:",y)}}async function o(){var d;try{const p=await fetch("books",{method:"GET"}),y=await p.json();p.ok&&((d=y.books)==null?void 0:d.length)>0&&t(0,n=y.books)}catch(p){console.error("Fetch error:",p)}}function s(){c.book=he(this),t(1,c),t(0,n)}function l(){c.percentage=ne(this.value),t(1,c),t(0,n)}function g(){c.question=this.value,t(1,c),t(0,n)}return[n,c,h,f,a,s,l,g]}class be extends ue{constructor(e){super(),fe(this,e,me,pe,se,{})}}export{be as component};
